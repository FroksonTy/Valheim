### Valheim server

# Инструкция по установке
1. Зарегистрироваться на github.com (если нет аккаунта)
2. **ОБЯЗАТЕЛЬНЫЙ ШАГ!** Сказать мне о регистрации (прислать имя аккаунта)
3. На github.com пройти по ссылке **https://github.com/FroksonTy/Valheim.git** и принять приглашение в Collaborators.
4. Скачать git **https://git-scm.com/downloads/win**, стандартную версию
5. Установить git (всё протыкать по дефолту)
6. Создать пустую папку в произвольном месте (у меня "E:\git")
7. Скачать два исполняемых файла **pull_server.bat** и **push_server.bat**, разместить в любом удобном месте (например, на рабочем столе)
   - Рекомендуется использовать обновленный скрипт **pull_server (с автобэкапированием).bat**
9. Открыть на редактирование скачанные файлы любым текстовым редактором.
10. В обоих файлах изменить содержимое переменной GIT_CLONE_PARENT на путь к **КОРНЮ** вашей папки, которая создавалась на 6 шаге.

**ВАЖНО!**
* **Шаг для тех, у кого уже был создан мир / загружен старым батником (в папку worlds)**. 
* Открыть Valheim -> Начать игру -> Начать -> Выбрать мир **4BROTHERS** -> Управление сохранениями -> Раскрыть строку с миром, нажатием на кнопку ">" -> удалить все сохранения -> закрыть игру.

# Инструкция по использованию
1. Перед началом игры, если Вы хотите запустить сервер, запустить файл **pull_server.bat**. В данном случае Вы получите актуальные файлы мира с удалённого репозитория. После чего можно запускать игру и создавать сервер.
2. Закончив сессию, необходимо запустить файл **push_server.bat**, указать комментарий (политика git), например, - дату сессии. В данном случае файлы мира отправятся на удалённый репозиторий.<br>
    - В первый раз гит предложит авторизоваться в git (авторизуемся через браузер)<br>
     

## Возможные ошибки
* Если в процессе push'а/pull'а возникает ошибка "schannel: failed to receive handshake, SSL/TLS connection failed" - открываем .gitconfig и вместо строчки **sslBackend = schannel** пишем **sslbackend = openssl**.
* Если в процессе push'а возникает ошибка "fatal: unable to auto-detect email address.." - открываем git bash и прописываем **git config --global user.email "you@example.com"**, где почта в ковычках - Ваша почта GitHub.

**ОБЯЗАТЕЛЬНАЯ К ПРОЧТЕНИЮ ИНФОРМАЦИЯ:**
pull_server.bat работает по принципу загрузки, push_server.bat - сохранения. <br>
Если Вы использовали pull_server.bat и играли день, **ни в коем случае не нужно запускать его повторно**. Мир **перезатрется** последними данными с удалённого репозитория. _(пример: Вова загрузил данные, мы поиграли вечер пятницы. Потом Вова заходит в субботу и снова ебашит пул. Инста идёт нахуй сразу.)_<br>
Следующий раз pull должен применять уже **новый** хост. 

Приятного использования, КОЗЛОЕБЫ.

---------------------------------------------------
**13.03.2025 - Добавлена новая версия pull_server.bat**<br>
Данная версия скрипта после успешной загрузки данных с сервера не закрывает cmd. Периодически (настраивайте под себя) скрипт будет создавать резервные копии файлов мира в произвольную папку (настраивайте под себя). Это должно спасти от случайного pull'а, вместо push'а. Я рекомендую использовать его.<br>
### Настройка скрипта
1. строка 'set BACKUP_DIR="%USERPROFILE%\Desktop\Valheim_Backups"' - вместо ковычек укажите удобный для себя путь к папке под бэкапы _(самому папку создавать необязательно, скрипт создаст сам)_
2. строка 'set INTERVAL=600' - вместо 600, можете указать свое число (в секундах), которое будет определять периодичность создания резервных копий.<br><br>
**P.S. Не закрывайте cmd, пока играете в Valheim.**

**17.03.2025 - Обновлены оба скрипта для pull'а**<br>
Добавлена дополнительная проверка перед стартом скрипта. Скрипт спросит пользователя, действительно ли он хочет выполнить pull.
